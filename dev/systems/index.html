<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Systems · OpticSim.jl</title><meta name="title" content="Systems · OpticSim.jl"/><meta property="og:title" content="Systems · OpticSim.jl"/><meta property="twitter:title" content="Systems · OpticSim.jl"/><meta name="description" content="Documentation for OpticSim.jl."/><meta property="og:description" content="Documentation for OpticSim.jl."/><meta property="twitter:description" content="Documentation for OpticSim.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/logo.svg" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="OpticSim.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="OpticSim.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OpticSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Geometry</span><ul><li><a class="tocitem" href="../primitives/">Primitives</a></li><li><a class="tocitem" href="../transforms_and_vectors/">Transforms and Vectors</a></li><li><a class="tocitem" href="../csg/">CSG</a></li></ul></li><li><span class="tocitem">Optical</span><ul><li class="is-active"><a class="tocitem" href>Systems</a><ul class="internal"><li><a class="tocitem" href="#Assemblies"><span>Assemblies</span></a></li><li><a class="tocitem" href="#Images"><span>Images</span></a></li><li><a class="tocitem" href="#Systems"><span>Systems</span></a></li><li><a class="tocitem" href="#Tracing"><span>Tracing</span></a></li></ul></li><li><a class="tocitem" href="../emitters/">Emitters</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../lenses/">Lenses</a></li></ul></li><li><a class="tocitem" href="../ref/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Optical</a></li><li class="is-active"><a href>Systems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Systems</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/brianguenter/OpticSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/brianguenter/OpticSim.jl/blob/main/docs/src/systems.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Optical-Systems"><a class="docs-heading-anchor" href="#Optical-Systems">Optical Systems</a><a id="Optical-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Optical-Systems" title="Permalink"></a></h1><h2 id="Assemblies"><a class="docs-heading-anchor" href="#Assemblies">Assemblies</a><a id="Assemblies-1"></a><a class="docs-heading-anchor-permalink" href="#Assemblies" title="Permalink"></a></h2><p>All systems are made up of a <code>LensAssembly</code> which contains all the optical components in the system, excluding any sources (see <a href="../emitters/#Emitters">Emitters</a>) and the detector (see below).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.LensAssembly-systems" href="#OpticSim.LensAssembly-systems"><code>OpticSim.LensAssembly</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LensAssembly{T&lt;:Real}</code></pre><p>Structure which contains the elements of the optical system, these can be <a href="../ref/#OpticSim.CSGTree"><code>CSGTree</code></a> or <a href="../ref/#OpticSim.Surface"><code>Surface</code></a> objects.</p><p>In order to prevent type ambiguities bespoke structs are created for each possible number of elements e.g. <code>LensAssembly3</code>. These are parameterized by the types of the elements to prevent ambiguities. Basic surface types such as <a href="../ref/#OpticSim.Rectangle"><code>Rectangle</code></a> (which can occur in large numbers) are stored independently in <code>Vector</code>s, so type parameters are only needed for CSG objects.</p><p>Each struct looks like this:</p><pre><code class="language-julia hljs">struct LensAssemblyN{T,T1,T2,...,TN} &lt;: LensAssembly{T}
    axis::SVector{3,T}
    rectangles::Vector{Rectangle{T}}
    ellipses::Vector{Ellipse{T}}
    hexagons::Vector{Hexagon{T}}
    paraxials::Vector{ParaxialLens{T}}
    E1::T1
    E2::T2
    ...
    EN::TN
end</code></pre><p>Where <code>Ti &lt;: Union{Surface{T},CSGTree{T}}</code>.</p><p>To create a LensAssembly object the following functions can be used:</p><pre><code class="language-julia hljs">LensAssembly(elements::Vararg{Union{Surface{T},CSGTree{T},LensAssembly{T}}}; axis = SVector(0.0, 0.0, 1.0)) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/LensAssembly.jl#L5-L35">source</a></section></article><h2 id="Images"><a class="docs-heading-anchor" href="#Images">Images</a><a id="Images-1"></a><a class="docs-heading-anchor-permalink" href="#Images" title="Permalink"></a></h2><p>The detector image is stored within the system as a <code>HierarchicalImage</code> for memory efficiency.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.HierarchicalImage-systems" href="#OpticSim.HierarchicalImage-systems"><code>OpticSim.HierarchicalImage</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HierarchicalImage{T&lt;:Number} &lt;: AbstractArray{T,2}</code></pre><p>Image type which dynamically allocated memory for pixels when their value is set, the value of unset pixels is assumed to be zero.</p><p>This is used for the detector image of <a href="../ref/#OpticSim.AbstractOpticalSystem"><code>AbstractOpticalSystem</code></a>s which can typically be very high resolution, but often have a large proportion of the image blank.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/HierarchicalImage.jl#L7-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.reset!-systems" href="#OpticSim.reset!-systems"><code>OpticSim.reset!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset!(a::HierarchicalImage{T})</code></pre><p>Resets the pixels in the image to <code>zero(T)</code>. Do this rather than <code>image .= zero(T)</code> because that will cause every pixel to be accessed, and therefore allocated. For large images this can cause huge memory traffic.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/HierarchicalImage.jl#L94-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.sum!-systems" href="#OpticSim.sum!-systems"><code>OpticSim.sum!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sum!(a::HierarchicalImage{T}, b::HierarchicalImage{T})</code></pre><p>Add the contents of <code>b</code> to <code>a</code> in an efficient way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/HierarchicalImage.jl#L112-L116">source</a></section></article><h2 id="Systems"><a class="docs-heading-anchor" href="#Systems">Systems</a><a id="Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Systems" title="Permalink"></a></h2><p>There are two types of <code>AbstractOpticalSystem</code> which can be used depending on the requirements.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.AbstractOpticalSystem-systems" href="#OpticSim.AbstractOpticalSystem-systems"><code>OpticSim.AbstractOpticalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractOpticalSystem{T&lt;:Real}</code></pre><p>Abstract type for any optical system, must parameterized by the datatype of entities within the system <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.CSGOpticalSystem-systems" href="#OpticSim.CSGOpticalSystem-systems"><code>OpticSim.CSGOpticalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CSGOpticalSystem{T,D&lt;:Real,S&lt;:Surface{T},L&lt;:LensAssembly{T}} &lt;: AbstractOpticalSystem{T}</code></pre><p>An optical system containing a lens assembly with all optical elements and a detector surface with associated image. The system can be at a specified temperature and pressure.</p><p>There are two number types in the type signature. The <code>T</code> type parameter is the numeric type for geometry in the optical system, the <code>D</code> type parameter is the numeric type of the pixels in the detector image. This way you can have <code>Float64</code> geometry, where high precision is essential, but the pixels in the detector can be <code>Float32</code> since precision is much less critical for image data, or Complex if doing wave optic simulations.</p><p>The detector can be any <a href="../ref/#OpticSim.Surface"><code>Surface</code></a> which implements <a href="../primitives/#OpticSim.uv-primitives"><code>uv</code></a>, <a href="../primitives/#OpticSim.uvtopix-primitives"><code>uvtopix</code></a> and <a href="../csg/#OpticSim.onsurface-Union{Tuple{T}, Tuple{CSGTree{T}, T, T, T}} where T&lt;:Real-csg"><code>onsurface</code></a>, typically this is one of <a href="../ref/#OpticSim.Rectangle"><code>Rectangle</code></a>, <a href="../ref/#OpticSim.Ellipse"><code>Ellipse</code></a> or <a href="../ref/#OpticSim.SphericalCap"><code>SphericalCap</code></a>.</p><pre><code class="language-julia hljs">CSGOpticalSystem(
    assembly::LensAssembly,
    detector::Surface,
    detectorpixelsx = 1000,
    detectorpixelsy = 1000, ::Type{D} = Float32;
    temperature = AGFFileReader.TEMP_REF,
    pressure = AGFFileReader.PRESSURE_REF
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L21-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.AxisymmetricOpticalSystem-systems" href="#OpticSim.AxisymmetricOpticalSystem-systems"><code>OpticSim.AxisymmetricOpticalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AxisymmetricOpticalSystem{T,C&lt;:CSGOpticalSystem{T}} &lt;: AbstractOpticalSystem{T}</code></pre><p>Optical system which has lens elements and an image detector, created from a <code>DataFrame</code> containing prescription data.</p><p>These tags are supported for columns: <code>:Radius</code>, <code>:SemiDiameter</code>, <code>:SurfaceType</code>, <code>:Thickness</code>, <code>:Conic</code>, <code>:Parameters</code>, <code>:Reflectance</code>, <code>:Material</code>.</p><p>These tags are supported for entries in a <code>SurfaceType</code> column: <code>Object</code>, <code>Image</code>, <code>Stop</code>. Assumes the <code>Image</code> row will be the last row in the <code>DataFrame</code>.</p><p>In practice a <a href="../ref/#OpticSim.CSGOpticalSystem"><code>CSGOpticalSystem</code></a> is generated automatically and stored within this system.</p><pre><code class="language-julia hljs">AxisymmetricOpticalSystem{T}(
    prescription::DataFrame,
    detectorpixelsx = 1000,
    detectorpixelsy:: = 1000,
    ::Type{D} = Float32;
    temperature = AGFFileReader.TEMP_REF,
    pressure = AGFFileReader.PRESSURE_REF
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L284-L307">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.temperature-systems" href="#OpticSim.temperature-systems"><code>OpticSim.temperature</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature(system::AbstractOpticalSystem{T}) -&gt; T</code></pre><p>Get the temperature of <code>system</code> in °C.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L109-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.pressure-systems" href="#OpticSim.pressure-systems"><code>OpticSim.pressure</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pressure(system::AbstractOpticalSystem{T}) -&gt; T</code></pre><p>Get the pressure of <code>system</code> in Atm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L116-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.detectorimage-systems" href="#OpticSim.detectorimage-systems"><code>OpticSim.detectorimage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detectorimage(system::AbstractOpticalSystem{T}) -&gt; HierarchicalImage{D}</code></pre><p>Get the detector image of <code>system</code>. <code>D</code> is the datatype of the detector image and is not necessarily the same as the datatype of the system <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L99-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.resetdetector!-systems" href="#OpticSim.resetdetector!-systems"><code>OpticSim.resetdetector!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">resetdetector!(system::AbstractOpticalSystem{T})</code></pre><p>Reset the deterctor image of <code>system</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L122-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.assembly-systems" href="#OpticSim.assembly-systems"><code>OpticSim.assembly</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assembly(system::AbstractOpticalSystem{T}) -&gt; LensAssembly{T}</code></pre><p>Get the <a href="../ref/#OpticSim.LensAssembly"><code>LensAssembly</code></a> of <code>system</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L90-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.semidiameter-systems" href="#OpticSim.semidiameter-systems"><code>OpticSim.semidiameter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">semidiameter(system::AxisymmetricOpticalSystem{T}) -&gt; T</code></pre><p>Get the semidiameter of <code>system</code>, that is the semidiameter of the entrance pupil (i.e. first surface) of the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L455-L459">source</a></section></article><h2 id="Tracing"><a class="docs-heading-anchor" href="#Tracing">Tracing</a><a id="Tracing-1"></a><a class="docs-heading-anchor-permalink" href="#Tracing" title="Permalink"></a></h2><p>We can trace an individual <a href="../ref/#OpticSim.OpticalRay"><code>OpticalRay</code></a> through the system (or directly through a <a href="../ref/#OpticSim.LensAssembly"><code>LensAssembly</code></a>), or we can trace using an <a href="../ref/#OpticSim.OpticalRayGenerator"><code>OpticalRayGenerator</code></a> to create a large number of rays.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.trace-systems" href="#OpticSim.trace-systems"><code>OpticSim.trace</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trace(assembly::LensAssembly{T}, r::OpticalRay{T}, temperature::T = 20.0, pressure::T = 1.0; trackrays = nothing, test = false)</code></pre><p>Returns the ray as it exits the assembly in the form of a <a href="../ref/#OpticSim.LensTrace"><code>LensTrace</code></a> object if it hits any element in the assembly, otherwise <code>nothing</code>. Recursive rays are offset by a small amount (<code>RAY_OFFSET</code>) to prevent it from immediately reintersecting the same lens element.</p><p><code>trackrays</code> can be passed an empty vector to accumulate the <code>LensTrace</code> objects at each intersection of <code>ray</code> with a surface in the assembly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/LensAssembly.jl#L321-L328">source</a></section><section><div><pre><code class="language-julia hljs">trace(system::AbstractOpticalSystem{T}, ray::OpticalRay{T}; trackrays = nothing, test = false)</code></pre><p>Traces <code>system</code> with <code>ray</code>, if <code>test</code> is enabled then fresnel reflections are disabled and the power distribution will not be correct. Returns either a <a href="../ref/#OpticSim.LensTrace"><code>LensTrace</code></a> if the ray hits the detector or <code>nothing</code> otherwise.</p><p><code>trackrays</code> can be passed an empty vector to accumulate the <code>LensTrace</code> objects at each intersection of <code>ray</code> with a surface in the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L130-L138">source</a></section><section><div><pre><code class="language-julia hljs">trace(system::AbstractOpticalSystem{T}, raygenerator::OpticalRayGenerator{T}; printprog = true, test = false)</code></pre><p>Traces <code>system</code> with rays generated by <code>raygenerator</code> on a single thread. Optionally the progress can be printed to the REPL. If <code>test</code> is enabled then fresnel reflections are disabled and the power distribution will not be correct. If <code>outpath</code> is specified then the result will be saved to this path.</p><p>Returns the detector image of the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L481-L490">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.traceMT-systems" href="#OpticSim.traceMT-systems"><code>OpticSim.traceMT</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">traceMT(system::AbstractOpticalSystem{T}, raygenerator::OpticalRayGenerator{T}; printprog = true, test = false)</code></pre><p>Traces <code>system</code> with rays generated by <code>raygenerator</code> using as many threads as possible. Optionally the progress can be printed to the REPL. If <code>test</code> is enabled then fresnel reflections are disabled and the power distribution will not be correct. If <code>outpath</code> is specified then the result will be saved to this path.</p><p>Returns the accumulated detector image from all threads.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L541-L550">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.tracehits-systems" href="#OpticSim.tracehits-systems"><code>OpticSim.tracehits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tracehits(system::AbstractOpticalSystem{T}, raygenerator::OpticalRayGenerator{T}; printprog = true, test = false)</code></pre><p>Traces <code>system</code> with rays generated by <code>raygenerator</code> on a single thread. Optionally the progress can be printed to the REPL. If <code>test</code> is enabled then fresnel reflections are disabled and the power distribution will not be correct.</p><p>Returns a list of <a href="../ref/#OpticSim.LensTrace"><code>LensTrace</code></a>s which hit the detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L777-L785">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.tracehitsMT-systems" href="#OpticSim.tracehitsMT-systems"><code>OpticSim.tracehitsMT</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tracehitsMT(system::AbstractOpticalSystem{T}, raygenerator::OpticalRayGenerator{T}; printprog = true, test = false)</code></pre><p>Traces <code>system</code> with rays generated by <code>raygenerator</code> using as many threads as possible. Optionally the progress can be printed to the REPL. If <code>test</code> is enabled then fresnel reflections are disabled and the power distribution will not be correct.</p><p>Returns a list of <a href="../ref/#OpticSim.LensTrace"><code>LensTrace</code></a>s which hit the detector, accumulated from all threads.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/OpticalSystem.jl#L657-L665">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpticSim.LensTrace-systems" href="#OpticSim.LensTrace-systems"><code>OpticSim.LensTrace</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LensTrace{T&lt;:Real,N}</code></pre><p>Contains an intersection point and the ray segment leading to it from within an optical trace. The ray carries the path length, power, wavelength, number of intersections and source number, all of which are accessible directly on this class too.</p><p>Has the following accessor methods:</p><pre><code class="language-julia hljs">ray(a::LensTrace{T,N}) -&gt; OpticalRay{T,N}
intersection(a::LensTrace{T,N}) -&gt; Intersection{T,N}
power(a::LensTrace{T,N}) -&gt; T
wavelength(a::LensTrace{T,N}) -&gt; T
pathlength(a::LensTrace{T,N}) -&gt; T
point(a::LensTrace{T,N}) -&gt; SVector{N,T}
uv(a::LensTrace{T,N}) -&gt; SVector{2,T}
sourcenum(a::LensTrace{T,N}) -&gt; Int
nhits(a::LensTrace{T,N}) -&gt; Int</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brianguenter/OpticSim.jl/blob/92fcf0eafd89b32360372f47d48979c2a568f045/src/Optical/LensAssembly.jl#L271-L290">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../csg/">« CSG</a><a class="docs-footer-nextpage" href="../emitters/">Emitters »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 11 November 2025 20:15">Tuesday 11 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
